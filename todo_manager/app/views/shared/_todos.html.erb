<%= button_to(t('dictionary.all'), sort: @sort, direction: @direction, search: '', status: '', label: '') %>
<%= button_to(t('status.unstarted'), sort: @sort, direction: @direction, search: @search, status: 'unstarted', label: @label) %>
<%= button_to(t('status.working'), sort: @sort, direction: @direction, search: @search, status: 'working', label: @label) %>
<%= button_to(t('status.completed'), sort: @sort, direction: @direction, search: @search, status: 'completed', label: @label) %>
<%= form_tag(request.path_info) do %>
  <input type="search" name="search">
  <input type="hidden" name="sort" value="<%= @sort %>">
  <input type="hidden" name="direction" value="<%= @direction %>">
  <input type="hidden" name="status" value="<%= @status %>">
  <input type="hidden" name="label" value="<%= @label %>">
  <%= submit_tag(t('dictionary.search')) %>
<% end %>
<%= link_to(t('dictionary.create'), request.path_info == root_path ? '/todos/new' : './new') %>
<table border="1">
  <thead>
  <tr>
    <th><%= link_to(t('dictionary.priority'), sort: 'priority_id', direction: @direction == 'desc' ? 'asc' : 'desc', search: @search, status: @status, label: @label) %></th>
    <th><%= t('dictionary.status') %></th>
    <th><%= t('dictionary.title') %></th>
    <th><%= t('dictionary.content') %></th>
    <th><%= t('dictionary.label') %></th>
    <th><%= link_to(t('dictionary.deadline'), sort: 'deadline', direction: @direction == 'desc' ? 'asc' : 'desc', search: @search, status: @status, label: @label) %></th>
  </tr>
  </thead>
  <tbody>
  <% @todos.each do |todo| %>
    <tr>
      <th><%= t("priority.#{todo.priority_id}") %></th>
      <th><%= t("status.#{todo.status_id}") %></th>
      <th><%= link_to(todo.title, "/todos/#{todo.id}/detail") %></th>
      <th><%= todo.content %></th>
      <th>
        <% todo.labels.each do |label| %>
          <%= link_to(label.name, sort: @sort, direction: @direction, search: @search, status: @status, label: label.name) %>
        <% end %>
      </th>
      <th style="color:<%= 'red' if !todo.deadline.nil? and todo.deadline < Time.current %>">
        <%= l(todo.deadline, format: :long) if !todo.deadline.nil? %>
      </th>
    </tr>
  <% end %>
  </tbody>
  <%= paginate @todos %>
</table>
